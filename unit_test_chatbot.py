#!/usr/bin/env python3
"""
Unit test for RAG chatbot with various question types.
Tests different intents and scenarios to evaluate system performance.
"""

import sys
import os
sys.path.append('/app')

import requests
import json
import time
from typing import List, Dict, Any

class ChatbotTester:
    def __init__(self, base_url: str = "http://localhost:8000"):
        self.base_url = base_url
        self.api_url = f"{base_url}/api/query"
        
    def test_query(self, query: str) -> Dict[str, Any]:
        """Test a single query and return results"""
        payload = {
            "q": query,
            "k": 5
        }
        
        try:
            response = requests.post(self.api_url, json=payload, timeout=120)
            response.raise_for_status()
            return response.json()
        except Exception as e:
            return {
                "query": query,
                "answer": f"ERROR: {str(e)}",
                "score": 0,
                "sources": []
            }
    
    def run_category_test(self, category_name: str) -> None:
        """Run tests for a specific category only"""
        test_cases = self._get_test_cases()
        
        # Find the specific category
        target_category = None
        for test_group in test_cases:
            if category_name.lower() in test_group['category'].lower():
                target_category = test_group
                break
        
        if not target_category:
            print(f"âŒ Category '{category_name}' not found!")
            return
        
        print("=" * 80)
        print(f"ðŸ¤– RAG CHATBOT - {target_category['category'].upper()}")
        print("=" * 80)
        print()
        
        total_tests = 0
        total_score = 0
        
        print(f"ðŸ“‚ {target_category['category']}")
        print("-" * 50)
        
        for question in target_category['questions']:
            total_tests += 1
            print(f"\nâ“ Ð’ÑŠÐ¿Ñ€Ð¾Ñ: {question}")
            
            result = self.test_query(question)
            score = result.get('score', 0)
            answer = result.get('answer', 'ÐÑÐ¼Ð° Ð¾Ñ‚Ð³Ð¾Ð²Ð¾Ñ€')
            sources = result.get('sources', [])
            
            total_score += score
            
            print(f"ðŸ“Š Score: {score}/100")
            print(f"ðŸ’¬ ÐžÑ‚Ð³Ð¾Ð²Ð¾Ñ€: {answer}")
            
            if sources:
                print(f"ðŸ“š Ð˜Ð·Ñ‚Ð¾Ñ‡Ð½Ð¸Ñ†Ð¸ ({len(sources)}):")
                for source in sources[:3]:  # Show max 3 sources
                    source_id = source.get('source_id', 'N/A')
                    relevance = source.get('relevance', 0)
                    print(f"   â€¢ {source_id} ({relevance:.1f}%)")
            
            # Add small delay to avoid overwhelming the API
            time.sleep(0.5)
        
        # Summary for category
        avg_score = total_score / total_tests if total_tests > 0 else 0
        high_score_tests = sum(1 for _ in range(total_tests) if avg_score >= 80)
        
        print(f"\nðŸ“ˆ CATEGORY SUMMARY:")
        print(f"   Tests: {total_tests}")
        print(f"   Average score: {avg_score:.1f}/100")
        print(f"   Success rate: {(high_score_tests/total_tests)*100:.1f}%")
        print("=" * 80)

    def _get_test_cases(self) -> List[Dict[str, Any]]:
        """Get all test cases"""
        return [
            # Product queries - Ð¾Ð±Ñ‰Ð¸
            {
                "category": "ÐŸÑ€Ð¾Ð´ÑƒÐºÑ‚Ð¸ - Ð¾Ð±Ñ‰Ð¸",
                "questions": [
                    "ÐšÐ°ÐºÐ²Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¸ Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°Ñ‚Ðµ?",
                    "ÐšÐ°ÐºÐ²Ð¾ Ð¸Ð¼Ð°Ñ‚Ðµ Ð² ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ð°?",
                    "ÐŸÐ¾ÐºÐ°Ð¶ÐµÑ‚Ðµ Ð¼Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¸Ñ‚Ðµ",
                    "ÐšÐ°ÐºÐ²Ð¾ Ð¿Ñ€Ð¾Ð´Ð°Ð²Ð°Ñ‚Ðµ?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ ÑÑ‚Ð¾ÐºÐ¸?",
                    "ÐšÐ°ÐºÑŠÐ² Ðµ Ð²Ð°ÑˆÐ¸ÑÑ‚ Ð°ÑÐ¾Ñ€Ñ‚Ð¸Ð¼ÐµÐ½Ñ‚?",
                    "ÐŸÐ¾ÐºÐ°Ð¶ÐµÑ‚Ðµ Ð¼Ð¸ Ð½Ð°Ð»Ð¸Ñ‡Ð½Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¸",
                    "ÐšÐ°ÐºÐ²Ð¸ ÑÑ‚Ð¾ÐºÐ¸ Ð¸Ð¼Ð°Ñ‚Ðµ?"
                ]
            },
            # ÐŸÑ€Ð¾Ð´ÑƒÐºÑ‚Ð¸ - ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸
            {
                "category": "ÐŸÑ€Ð¾Ð´ÑƒÐºÑ‚Ð¸ - ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸", 
                "questions": [
                    "ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°Ñ‚Ðµ Ð»Ð¸ Ð»Ð°Ð¿Ñ‚Ð¾Ð¿Ð¸?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð¸?",
                    "ÐŸÑ€Ð¾Ð´Ð°Ð²Ð°Ñ‚Ðµ Ð»Ð¸ Ñ‡Ð°ÑÐ¾Ð²Ð½Ð¸Ñ†Ð¸?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ñ‚Ð°Ð±Ð»ÐµÑ‚Ð¸?",
                    "ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°Ñ‚Ðµ Ð»Ð¸ ÑÐ¼Ð°Ñ€Ñ‚Ñ„Ð¾Ð½Ð¸?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð¼Ð¾Ð±Ð¸Ð»Ð½Ð¸ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð¸?",
                    "ÐŸÑ€Ð¾Ð´Ð°Ð²Ð°Ñ‚Ðµ Ð»Ð¸ ÐºÐ¾Ð¼Ð¿ÑŽÑ‚Ñ€Ð¸?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð½Ð¾ÑƒÑ‚Ð±ÑƒÑ†Ð¸?",
                    "ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°Ñ‚Ðµ Ð»Ð¸ ÑÐ»ÑƒÑˆÐ°Ð»ÐºÐ¸?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ ÐºÐ°Ð¼ÐµÑ€Ð¸?",
                    "ÐŸÑ€Ð¾Ð´Ð°Ð²Ð°Ñ‚Ðµ Ð»Ð¸ Ð¿Ñ€Ð¸Ð½Ñ‚ÐµÑ€Ð¸?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸?",
                    "ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°Ñ‚Ðµ Ð»Ð¸ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ð¸?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð¼Ð¸ÑˆÐºÐ¸?",
                    "ÐŸÑ€Ð¾Ð´Ð°Ð²Ð°Ñ‚Ðµ Ð»Ð¸ Ð´Ñ€Ð¾Ð½Ð¾Ð²Ðµ?"
                ]
            },
            # ÐŸÐ»Ð°Ñ‰Ð°Ð½Ðµ Ð¸ Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ¸
            {
                "category": "ÐŸÐ»Ð°Ñ‰Ð°Ð½Ðµ Ð¸ Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ¸",
                "questions": [
                    "ÐšÐ°Ðº Ð¼Ð¾Ð³Ð° Ð´Ð° Ð¿Ð»Ð°Ñ‚Ñ?",
                    "ÐœÐ¾Ð¶Ðµ Ð»Ð¸ Ð´Ð° Ð¿Ð»Ð°Ñ‚Ñ Ñ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð° ÐºÐ°Ñ€Ñ‚Ð°?",
                    "ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°Ñ‚Ðµ Ð»Ð¸ Ñ€Ð°Ð·ÑÑ€Ð¾Ñ‡ÐµÐ½Ð¾ Ð¿Ð»Ð°Ñ‰Ð°Ð½Ðµ?",
                    "ÐšÐ°Ðº Ð´Ð° Ð½Ð°Ð¿Ñ€Ð°Ð²Ñ Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ°?",
                    "ÐšÐ°ÐºÐ²Ð¸ ÑÐ° Ð½Ð°Ñ‡Ð¸Ð½Ð¸Ñ‚Ðµ Ð½Ð° Ð¿Ð»Ð°Ñ‰Ð°Ð½Ðµ?",
                    "ÐŸÑ€Ð¸ÐµÐ¼Ð°Ñ‚Ðµ Ð»Ð¸ ÐºÐ°Ñ€Ñ‚Ð¸?",
                    "ÐœÐ¾Ð³Ð° Ð»Ð¸ Ð´Ð° Ð¿Ð»Ð°Ñ‚Ñ Ñ ÐºÐ°Ñ€Ñ‚Ð°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð½Ð°Ð»Ð¾Ð¶ÐµÐ½ Ð¿Ð»Ð°Ñ‚ÐµÐ¶?",
                    "ÐšÐ°Ðº ÑÐµ Ð¿Ð»Ð°Ñ‰Ð°?",
                    "ÐœÐ¾Ð¶Ðµ Ð»Ð¸ Ð±Ð°Ð½ÐºÐ¾Ð² Ð¿Ñ€ÐµÐ²Ð¾Ð´?",
                    "ÐŸÑ€Ð¸ÐµÐ¼Ð°Ñ‚Ðµ Ð»Ð¸ PayPal?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ñ€Ð°Ð·ÑÑ€Ð¾Ñ‡ÐµÐ½Ð¾ Ð¿Ð»Ð°Ñ‰Ð°Ð½Ðµ?",
                    "ÐšÐ°Ðº Ð´Ð° Ð¿Ð»Ð°Ñ‚Ñ Ð¾Ð½Ð»Ð°Ð¹Ð½?",
                    "ÐœÐ¾Ð³Ð° Ð»Ð¸ Ð´Ð° Ð¿Ð»Ð°Ñ‚Ñ Ð¿Ñ€Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°?",
                    "ÐšÐ°ÐºÐ²Ð¸ ÑÐ° Ð¾Ð¿Ñ†Ð¸Ð¸Ñ‚Ðµ Ð·Ð° Ð¿Ð»Ð°Ñ‰Ð°Ð½Ðµ?"
                ]
            },
            # Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ° Ð¸ Ð¿Ñ€Ð¾ÑÐ»ÐµÐ´ÑÐ²Ð°Ð½Ðµ
            {
                "category": "Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ° Ð¸ Ð¿Ñ€Ð¾ÑÐ»ÐµÐ´ÑÐ²Ð°Ð½Ðµ",
                "questions": [
                    "ÐšÐ¾Ð³Ð° Ñ‰Ðµ Ð¿Ñ€Ð¸ÑÑ‚Ð¸Ð³Ð½Ðµ Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ°Ñ‚Ð°?",
                    "ÐšÐ°Ðº Ð¼Ð¾Ð³Ð° Ð´Ð° Ð¿Ñ€Ð¾ÑÐ»ÐµÐ´Ñ Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ°Ñ‚Ð° ÑÐ¸?",
                    "ÐšÐ¾Ð»ÐºÐ¾ Ð²Ñ€ÐµÐ¼Ðµ Ð¾Ñ‚Ð½ÐµÐ¼Ð° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°Ñ‚Ð°?",
                    "ÐšÐ¾Ð³Ð° Ñ‰Ðµ Ð´Ð¾Ð¹Ð´Ðµ Ð¿Ñ€Ð°Ñ‚ÐºÐ°Ñ‚Ð°?",
                    "ÐšÐ°ÐºÐ²Ð¾ Ðµ Ð²Ñ€ÐµÐ¼ÐµÑ‚Ð¾ Ð·Ð° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°?",
                    "ÐšÐ¾Ð»ÐºÐ¾ Ð´Ð½Ð¸ Ð¾Ñ‚Ð½ÐµÐ¼Ð° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°Ñ‚Ð°?",
                    "ÐšÐ¾Ð³Ð° Ñ‰Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð° Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ°Ñ‚Ð°?",
                    "ÐšÐ°Ðº Ð´Ð° Ð¿Ñ€Ð¾ÑÐ»ÐµÐ´Ñ Ð¿Ñ€Ð°Ñ‚ÐºÐ°Ñ‚Ð°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ ÐµÐºÑÐ¿Ñ€ÐµÑÐ½Ð° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°?",
                    "ÐšÐ¾Ð»ÐºÐ¾ Ð²Ñ€ÐµÐ¼Ðµ Ð¾Ñ‚Ð½ÐµÐ¼Ð° Ð´Ð¾ Ð¡Ð¾Ñ„Ð¸Ñ?",
                    "Ð”Ð¾ÑÑ‚Ð°Ð²ÑÑ‚Ðµ Ð»Ð¸ Ð² Ñ‡ÑƒÐ¶Ð±Ð¸Ð½Ð°?",
                    "ÐšÐ°ÐºÐ²Ð¸ ÑÐ° ÑÑ€Ð¾ÐºÐ¾Ð²ÐµÑ‚Ðµ Ð·Ð° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°?",
                    "ÐšÐ¾Ð³Ð° Ñ‰Ðµ Ð¿Ñ€Ð¸ÑÑ‚Ð¸Ð³Ð½Ðµ Ð² Ð¡Ð¾Ñ„Ð¸Ñ?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð±ÐµÐ·Ð¿Ð»Ð°Ñ‚Ð½Ð° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°?",
                    "ÐšÐ¾Ð»ÐºÐ¾ ÑÑ‚Ñ€ÑƒÐ²Ð° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°Ñ‚Ð°?"
                ]
            },
            # Ð“Ð°Ñ€Ð°Ð½Ñ†Ð¸Ñ Ð¸ ÑÐµÑ€Ð²Ð¸Ð·
            {
                "category": "Ð“Ð°Ñ€Ð°Ð½Ñ†Ð¸Ñ Ð¸ ÑÐµÑ€Ð²Ð¸Ð·",
                "questions": [
                    "ÐšÐ°ÐºÐ²Ð° Ð³Ð°Ñ€Ð°Ð½Ñ†Ð¸Ñ Ð¸Ð¼Ð°Ñ‚Ðµ?",
                    "ÐšÑŠÐ´Ðµ Ð¼Ð¾Ð³Ð° Ð´Ð° Ð¿Ð¾Ð¿Ñ€Ð°Ð²Ñ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚?",
                    "ÐšÐ°Ðº Ð´Ð° Ð½Ð°Ð¿Ñ€Ð°Ð²Ñ Ñ€ÐµÐºÐ»Ð°Ð¼Ð°Ñ†Ð¸Ñ?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð³Ð°Ñ€Ð°Ð½Ñ†Ð¸Ñ?",
                    "ÐšÐ¾Ð»ÐºÐ¾ Ðµ Ð³Ð°Ñ€Ð°Ð½Ñ†Ð¸ÑÑ‚Ð°?",
                    "ÐšÐ°ÐºÐ²Ð° Ðµ Ð³Ð°Ñ€Ð°Ð½Ñ†Ð¸ÑÑ‚Ð° Ð·Ð° Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¸Ñ‚Ðµ?",
                    "ÐšÑŠÐ´Ðµ Ðµ ÑÐµÑ€Ð²Ð¸Ð·ÑŠÑ‚?",
                    "ÐšÐ°Ðº Ð´Ð° Ð½Ð°Ð¿Ñ€Ð°Ð²Ñ Ñ€ÐµÐ¼Ð¾Ð½Ñ‚?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ ÑÐµÑ€Ð²Ð¸Ð·?",
                    "ÐšÑŠÐ´Ðµ Ð¼Ð¾Ð³Ð° Ð´Ð° Ð¿Ð¾Ð¿Ñ€Ð°Ð²Ñ Ð»Ð°Ð¿Ñ‚Ð¾Ð¿Ð°?",
                    "ÐšÐ°ÐºÐ²Ð° Ðµ Ð³Ð°Ñ€Ð°Ð½Ñ†Ð¸ÑÑ‚Ð° Ð·Ð° Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð³Ð°Ñ€Ð°Ð½Ñ†Ð¸Ñ Ð·Ð° ÑÐ»ÑƒÑˆÐ°Ð»ÐºÐ¸Ñ‚Ðµ?",
                    "ÐšÑŠÐ´Ðµ Ð¼Ð¾Ð³Ð° Ð´Ð° Ð¿Ð¾Ð¿Ñ€Ð°Ð²Ñ Ð¿Ñ€Ð¸Ð½Ñ‚ÐµÑ€Ð°?",
                    "ÐšÐ°Ðº Ð´Ð° Ð½Ð°Ð¿Ñ€Ð°Ð²Ñ Ñ€ÐµÐºÐ»Ð°Ð¼Ð°Ñ†Ð¸Ñ Ð·Ð° Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ ÑÐµÑ€Ð²Ð¸Ð·ÐµÐ½ Ñ†ÐµÐ½Ñ‚ÑŠÑ€?"
                ]
            },
            # Ð Ð°Ð±Ð¾Ñ‚Ð½Ð¾ Ð²Ñ€ÐµÐ¼Ðµ
            {
                "category": "Ð Ð°Ð±Ð¾Ñ‚Ð½Ð¾ Ð²Ñ€ÐµÐ¼Ðµ",
                "questions": [
                    "Ð Ð°Ð±Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð»Ð¸ Ð² Ð½ÐµÐ´ÐµÐ»Ñ?",
                    "ÐšÐ¾Ð³Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ð¸Ñ‚Ðµ?",
                    "Ð Ð°Ð±Ð¾Ñ‚Ð½Ð¾ Ð²Ñ€ÐµÐ¼Ðµ",
                    "ÐžÑ‚Ð²Ð¾Ñ€ÐµÐ½Ð¸ Ð»Ð¸ ÑÑ‚Ðµ Ð² ÑÑŠÐ±Ð¾Ñ‚Ð°?",
                    "Ð”Ð¾ ÐºÐ¾Ð»ÐºÐ¾ Ñ‡Ð°ÑÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ð¸Ñ‚Ðµ?",
                    "ÐžÑ‚ ÐºÐ¾Ð»ÐºÐ¾ Ñ‡Ð°ÑÐ° Ð¾Ñ‚Ð²Ð°Ñ€ÑÑ‚Ðµ?",
                    "Ð Ð°Ð±Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð»Ð¸ Ð² Ð¿Ð¾Ñ‡Ð¸Ð²Ð½Ð¸ Ð´Ð½Ð¸?",
                    "Ð“Ñ€Ð°Ñ„Ð¸Ðº Ð½Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ð°",
                    "ÐšÐ¾Ð³Ð° ÑÑ‚Ðµ Ð¾Ñ‚Ð²Ð¾Ñ€ÐµÐ½Ð¸?",
                    "Ð Ð°Ð±Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð»Ð¸ Ð² Ð¿Ñ€Ð°Ð·Ð½Ð¸Ñ†Ð¸?",
                    "ÐžÑ‚Ð²Ð¾Ñ€ÐµÐ½Ð¸ Ð»Ð¸ ÑÑ‚Ðµ Ð´Ð½ÐµÑ?",
                    "ÐšÐ¾Ð³Ð° Ð·Ð°Ñ‚Ð²Ð°Ñ€ÑÑ‚Ðµ?",
                    "Ð Ð°Ð±Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð»Ð¸ Ð²ÐµÑ‡ÐµÑ€?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð¿Ð¾Ñ‡Ð¸Ð²Ð½Ð¸ Ð´Ð½Ð¸?",
                    "ÐšÐ¾Ð³Ð° ÑÑ‚Ðµ Ð·Ð°Ñ‚Ð²Ð¾Ñ€ÐµÐ½Ð¸?"
                ]
            },
            # ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ð° Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ
            {
                "category": "ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ð° Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ",
                "questions": [
                    "ÐšÐ°Ðº Ð´Ð° ÑÐµ ÑÐ²ÑŠÑ€Ð¶Ð° Ñ Ð²Ð°Ñ?",
                    "ÐšÑŠÐ´Ðµ ÑÐµ Ð½Ð°Ð¼Ð¸Ñ€Ð°Ñ‚Ðµ?",
                    "ÐšÐ°ÐºÑŠÐ² Ðµ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½ÑŠÑ‚ Ð²Ð¸?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ email?",
                    "ÐšÐ°ÐºÑŠÐ² Ðµ Ð°Ð´Ñ€ÐµÑÑŠÑ‚ Ð²Ð¸?",
                    "ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ð° Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ",
                    "Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½ Ð·Ð° Ð²Ñ€ÑŠÐ·ÐºÐ°",
                    "Email Ð°Ð´Ñ€ÐµÑ",
                    "ÐÐ´Ñ€ÐµÑ Ð½Ð° Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½Ð°",
                    "ÐšÐ°Ðº Ð´Ð° Ð²Ð¸ Ð½Ð°Ð¼ÐµÑ€Ñ?",
                    "ÐšÑŠÐ´Ðµ ÑÑ‚Ðµ?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð¾Ñ„Ð¸Ñ?",
                    "ÐšÐ°Ðº Ð´Ð° ÑÐµ ÑÐ²ÑŠÑ€Ð¶Ð° Ñ Ð¿Ð¾Ð´Ð´Ñ€ÑŠÐ¶ÐºÐ°Ñ‚Ð°?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ñ‡Ð°Ñ‚ Ð¿Ð¾Ð´Ð´Ñ€ÑŠÐ¶ÐºÐ°?",
                    "ÐšÐ°Ðº Ð´Ð° Ð²Ð¸ Ð¿Ð¸ÑˆÐ°?"
                ]
            },
            # ÐŸÐ¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ Ð¸ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ
            {
                "category": "ÐŸÐ¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ Ð¸ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ",
                "questions": [
                    "ÐšÐ°ÐºÐ²Ð° Ðµ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ°Ñ‚Ð° Ð·Ð° Ð²Ñ€ÑŠÑ‰Ð°Ð½Ðµ?",
                    "ÐœÐ¾Ð³Ð° Ð»Ð¸ Ð´Ð° Ð²ÑŠÑ€Ð½Ð° Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚?",
                    "ÐšÐ°Ðº Ð´Ð° Ð²ÑŠÑ€Ð½Ð° ÑÑ‚Ð¾ÐºÐ°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð²Ñ€ÑŠÑ‰Ð°Ð½Ðµ Ð½Ð° Ð¿Ð°Ñ€Ð¸Ñ‚Ðµ?",
                    "ÐšÐ°ÐºÐ²Ð¸ ÑÐ° ÑƒÑÐ»Ð¾Ð²Ð¸ÑÑ‚Ð° Ð·Ð° Ð²Ñ€ÑŠÑ‰Ð°Ð½Ðµ?",
                    "ÐšÐ¾Ð»ÐºÐ¾ Ð´Ð½Ð¸ Ð¸Ð¼Ð°Ð¼ Ð·Ð° Ð²Ñ€ÑŠÑ‰Ð°Ð½Ðµ?",
                    "ÐœÐ¾Ð³Ð° Ð»Ð¸ Ð´Ð° Ð¾Ñ‚Ð¼ÐµÐ½Ñ Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ°?",
                    "ÐšÐ°Ðº Ð´Ð° Ð¾Ñ‚Ð¼ÐµÐ½Ñ Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ñ‚Ð°ÐºÑÐ° Ð·Ð° Ð²Ñ€ÑŠÑ‰Ð°Ð½Ðµ?",
                    "ÐšÐ°Ðº Ð´Ð° Ð½Ð°Ð¿Ñ€Ð°Ð²Ñ Ñ€ÐµÐºÐ»Ð°Ð¼Ð°Ñ†Ð¸Ñ?",
                    "ÐšÐ°ÐºÐ²Ð¸ ÑÐ° ÑƒÑÐ»Ð¾Ð²Ð¸ÑÑ‚Ð° Ð·Ð° Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ?",
                    "ÐšÐ°ÐºÐ²Ð¸ ÑÐ° Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ñ‚Ð°?",
                    "ÐœÐ¾Ð³Ð° Ð»Ð¸ Ð´Ð° Ð¿Ñ€Ð¾Ð¼ÐµÐ½Ñ Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ°?",
                    "ÐšÐ°Ðº Ð´Ð° Ð¿Ñ€Ð¾Ð¼ÐµÐ½Ñ Ð°Ð´Ñ€ÐµÑÐ°?"
                ]
            },
            # Ð¦ÐµÐ½Ð¸ Ð¸ Ð¿Ñ€Ð¾Ð¼Ð¾Ñ†Ð¸Ð¸
            {
                "category": "Ð¦ÐµÐ½Ð¸ Ð¸ Ð¿Ñ€Ð¾Ð¼Ð¾Ñ†Ð¸Ð¸",
                "questions": [
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð¿Ñ€Ð¾Ð¼Ð¾Ñ†Ð¸Ð¸?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð¾Ñ‚ÑÑ‚ÑŠÐ¿ÐºÐ¸?",
                    "ÐšÐ°ÐºÐ²Ð¸ ÑÐ° Ñ†ÐµÐ½Ð¸Ñ‚Ðµ?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð½Ð°Ð¼Ð°Ð»ÐµÐ½Ð¸Ñ?",
                    "ÐšÐ¾Ð»ÐºÐ¾ ÑÑ‚Ñ€ÑƒÐ²Ð° Ñ‚Ð¾Ð²Ð°?",
                    "ÐšÐ°ÐºÐ²Ð° Ðµ Ñ†ÐµÐ½Ð°Ñ‚Ð°?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð¿Ñ€Ð¾Ð¼Ð¾ ÐºÐ¾Ð´?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð²Ð°ÑƒÑ‡ÐµÑ€Ð¸?",
                    "ÐšÐ°ÐºÐ²Ð¸ ÑÐ° Ð°ÐºÑ†Ð¸Ð¸Ñ‚Ðµ?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð½Ð¸ Ð¾Ñ„ÐµÑ€Ñ‚Ð¸?",
                    "ÐšÐ¾Ð»ÐºÐ¾ ÑÑ‚Ñ€ÑƒÐ²Ð° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°Ñ‚Ð°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð±ÐµÐ·Ð¿Ð»Ð°Ñ‚Ð½Ð° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°?",
                    "ÐšÐ°ÐºÐ²Ð¸ ÑÐ° Ñ‚Ð°ÐºÑÐ¸Ñ‚Ðµ?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ ÑÐºÑ€Ð¸Ñ‚Ð¸ Ñ‚Ð°ÐºÑÐ¸?",
                    "ÐšÐ°ÐºÐ²Ð° Ðµ Ð¾Ð±Ñ‰Ð°Ñ‚Ð° Ñ†ÐµÐ½Ð°?"
                ]
            },
            # Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸ Ð²ÑŠÐ¿Ñ€Ð¾ÑÐ¸
            {
                "category": "Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸ Ð²ÑŠÐ¿Ñ€Ð¾ÑÐ¸",
                "questions": [
                    "ÐšÐ°Ðº Ð´Ð° Ð½Ð°ÑÑ‚Ñ€Ð¾Ñ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸?",
                    "ÐšÐ°Ðº Ð´Ð° Ð¸Ð·Ð¿Ð¾Ð»Ð·Ð²Ð°Ð¼ Ñ‚Ð¾Ð²Ð°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ñ€ÑŠÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾?",
                    "ÐšÐ°Ðº Ð´Ð° Ð¸Ð½ÑÑ‚Ð°Ð»Ð¸Ñ€Ð°Ð¼ ÑÐ¾Ñ„Ñ‚ÑƒÐµÑ€Ð°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð´Ñ€Ð°Ð¹Ð²ÐµÑ€Ð¸?",
                    "ÐšÐ°Ðº Ð´Ð° ÑÐ²ÑŠÑ€Ð¶Ð° ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð¾Ñ‚Ð¾?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ ÐºÐ°Ð±ÐµÐ»Ð¸?",
                    "ÐšÐ°Ðº Ð´Ð° Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð°Ð¼ Ð³Ð°Ñ€Ð°Ð½Ñ†Ð¸ÑÑ‚Ð°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ ÑÐ¾Ñ„Ñ‚ÑƒÐµÑ€?",
                    "ÐšÐ°Ðº Ð´Ð° Ð¾Ð±Ð½Ð¾Ð²Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°Ñ‚Ð°?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ñ„Ð¸ÑŠÑ€Ð¼ÑƒÐµÑ€?",
                    "ÐšÐ°Ðº Ð´Ð° Ñ€ÐµÑÑ‚Ð°Ñ€Ñ‚Ð¸Ñ€Ð°Ð¼ ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð¾Ñ‚Ð¾?",
                    "Ð˜Ð¼Ð° Ð»Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð¸ Ñ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°?",
                    "ÐšÐ°Ðº Ð´Ð° Ñ€ÐµÑˆÐ° Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð°?"
                ]
            },
            # Edge cases - Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð½Ð¸ ÑÐ»ÑƒÑ‡Ð°Ð¸
            {
                "category": "Edge Cases - Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð½Ð¸ ÑÐ»ÑƒÑ‡Ð°Ð¸",
                "questions": [
                    "ÐšÐ°ÐºÐ²Ð¾ Ðµ ÐºÐ²Ð°Ð½Ñ‚Ð¾Ð²Ð¾Ñ‚Ð¾ Ð¸Ð·Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ?",  # Ð˜Ð·Ð²ÑŠÐ½ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸ÑÑ‚Ð°
                    "ÐšÐ¾Ð»ÐºÐ¾ Ðµ 2+2?",  # ÐœÐ°Ñ‚ÐµÐ¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð²ÑŠÐ¿Ñ€Ð¾Ñ
                    "ÐšÐ°ÐºÐ²Ð¾ Ðµ Ð²Ñ€ÐµÐ¼ÐµÑ‚Ð¾?",  # ÐžÐ±Ñ‰ Ð²ÑŠÐ¿Ñ€Ð¾Ñ
                    "ÐšÐ¾Ð¹ Ðµ Ð¿Ñ€ÐµÐ·Ð¸Ð´ÐµÐ½Ñ‚ÑŠÑ‚?",  # ÐŸÐ¾Ð»Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð²ÑŠÐ¿Ñ€Ð¾Ñ
                    "ÐšÐ°Ðº Ð´Ð° Ð³Ð¾Ñ‚Ð²Ñ?",  # ÐšÑƒÐ»Ð¸Ð½Ð°Ñ€Ð½Ð¸ Ð²ÑŠÐ¿Ñ€Ð¾ÑÐ¸
                    "ÐšÐ°ÐºÐ²Ð¾ Ðµ Ð»ÑŽÐ±Ð¾Ð²Ñ‚Ð°?",  # Ð¤Ð¸Ð»Ð¾ÑÐ¾Ñ„ÑÐºÐ¸ Ð²ÑŠÐ¿Ñ€Ð¾Ñ
                    "ÐšÐ¾Ð»ÐºÐ¾ Ðµ Ð²Ð¸ÑÐ¾ÐºÐ¾ Ð½ÐµÐ±ÐµÑ‚Ð¾?",  # ÐÐ±ÑÑ‚Ñ€Ð°ÐºÑ‚ÐµÐ½ Ð²ÑŠÐ¿Ñ€Ð¾Ñ
                    "ÐšÐ°Ðº Ð´Ð° Ð»ÐµÑ‚Ñ?",  # ÐÐµÑ€ÐµÐ°Ð»ÐµÐ½ Ð²ÑŠÐ¿Ñ€Ð¾Ñ
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ñ…ÐµÐ»Ð¸ÐºÐ¾Ð¿Ñ‚ÐµÑ€Ð¸?",  # ÐÐµÑÑŠÑ‰ÐµÑÑ‚Ð²ÑƒÐ²Ð°Ñ‰ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚
                    "ÐŸÑ€Ð¾Ð´Ð°Ð²Ð°Ñ‚Ðµ Ð»Ð¸ ÑÐ°Ð¼Ð¾Ð»ÐµÑ‚Ð¸?",  # ÐÐµÑÑŠÑ‰ÐµÑÑ‚Ð²ÑƒÐ²Ð°Ñ‰ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚
                    "ÐšÐ°Ðº Ð´Ð° ÑÑ‚Ð°Ð½Ð° Ð¼Ð¸Ð»Ð¸Ð¾Ð½ÐµÑ€?",  # Ð¤Ð¸Ð½Ð°Ð½ÑÐ¾Ð² ÑÑŠÐ²ÐµÑ‚
                    "ÐšÐ°ÐºÐ²Ð¾ Ðµ Ð¶Ð¸Ð²Ð¾Ñ‚Ð°?",  # Ð¤Ð¸Ð»Ð¾ÑÐ¾Ñ„ÑÐºÐ¸ Ð²ÑŠÐ¿Ñ€Ð¾Ñ
                    "ÐšÐ¾Ð»ÐºÐ¾ Ð·Ð²ÐµÐ·Ð´Ð¸ Ð¸Ð¼Ð°?",  # ÐÑÑ‚Ñ€Ð¾Ð½Ð¾Ð¼Ð¸Ñ‡ÐµÑÐºÐ¸ Ð²ÑŠÐ¿Ñ€Ð¾Ñ
                    "ÐšÐ°Ðº Ð´Ð° ÑÐµ Ð½Ð°ÑƒÑ‡Ð° Ð´Ð° Ð»ÐµÑ‚Ñ?",  # ÐÐµÑ€ÐµÐ°Ð»ÐµÐ½ Ð²ÑŠÐ¿Ñ€Ð¾Ñ
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð¼Ð°Ð³Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿Ñ€ÑŠÑ‡ÐºÐ¸?"  # Ð¤Ð°Ð½Ñ‚Ð°ÑÑ‚Ð¸Ñ‡ÐµÐ½ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚
                ]
            },
            # Ð¡Ð»Ð¾Ð¶Ð½Ð¸ Ð²ÑŠÐ¿Ñ€Ð¾ÑÐ¸
            {
                "category": "Ð¡Ð»Ð¾Ð¶Ð½Ð¸ Ð²ÑŠÐ¿Ñ€Ð¾ÑÐ¸",
                "questions": [
                    "Ð˜ÑÐºÐ°Ð¼ Ð´Ð° ÐºÑƒÐ¿Ñ Ð»Ð°Ð¿Ñ‚Ð¾Ð¿, Ð½Ð¾ Ð½Ðµ Ð·Ð½Ð°Ð¼ ÐºÐ¾Ð¹ Ð´Ð° Ð¸Ð·Ð±ÐµÑ€Ð°. ÐœÐ¾Ð¶ÐµÑ‚Ðµ Ð»Ð¸ Ð´Ð° Ð¼Ð¸ Ð¿Ð¾Ð¼Ð¾Ð³Ð½ÐµÑ‚Ðµ?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð¿Ñ€ÐµÐ¿Ð¾Ñ€ÑŠÐºÐ¸ Ð·Ð° Ð´Ð¾Ð±ÑŠÑ€ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½ Ð¿Ð¾Ð´ 500 Ð»ÐµÐ²Ð°?",
                    "ÐšÐ¾Ð¹ Ðµ Ð½Ð°Ð¹-Ð´Ð¾Ð±Ñ€Ð¸ÑÑ‚ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚ Ð·Ð° ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚?",
                    "Ð˜ÑÐºÐ°Ð¼ Ð´Ð° Ð½Ð°Ð¿Ñ€Ð°Ð²Ñ Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ°, Ð½Ð¾ Ð¸Ð¼Ð°Ð¼ Ð²ÑŠÐ¿Ñ€Ð¾ÑÐ¸ Ð·Ð° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°Ñ‚Ð° Ð¸ Ð¿Ð»Ð°Ñ‰Ð°Ð½ÐµÑ‚Ð¾.",
                    "ÐœÐ¾Ð³Ð° Ð»Ð¸ Ð´Ð° Ð¿Ð¾Ñ€ÑŠÑ‡Ð°Ð¼ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚ Ð¸ Ð´Ð° Ð³Ð¾ Ð²ÑŠÑ€Ð½Ð° Ð°ÐºÐ¾ Ð½Ðµ Ð¼Ð¸ Ñ…Ð°Ñ€ÐµÑÐ°?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ Ð¿Ð°ÐºÐµÑ‚Ð½Ð¸ Ð¾Ñ„ÐµÑ€Ñ‚Ð¸ Ð·Ð° Ð¾Ñ„Ð¸Ñ Ð¾Ð±Ð¾Ñ€ÑƒÐ´Ð²Ð°Ð½Ðµ?",
                    "ÐšÐ°ÐºÐ²Ð° Ðµ Ñ€Ð°Ð·Ð»Ð¸ÐºÐ°Ñ‚Ð° Ð¼ÐµÐ¶Ð´Ñƒ Ð²Ð°ÑˆÐ¸Ñ‚Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¸ Ð¸ ÐºÐ¾Ð½ÐºÑƒÑ€ÐµÐ½Ñ‚Ð¸Ñ‚Ðµ?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ ÑÑŠÐ²ÐµÑ‚Ð¸ Ð·Ð° Ð¸Ð·Ð±Ð¾Ñ€ Ð½Ð° Ð¿Ð¾Ð´Ñ…Ð¾Ð´ÑÑ‰ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚?",
                    "ÐœÐ¾Ð³Ð° Ð»Ð¸ Ð´Ð° ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð¸Ñ€Ð°Ð¼ Ð½ÑÐºÐ¾Ð»ÐºÐ¾ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð° Ð² ÐµÐ´Ð½Ð° Ð¿Ð¾Ñ€ÑŠÑ‡ÐºÐ°?",
                    "Ð˜Ð¼Ð°Ñ‚Ðµ Ð»Ð¸ ÑƒÑÐ»ÑƒÐ³Ð° Ð·Ð° Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð½Ð° Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¸Ñ‚Ðµ?"
                ]
            }
        ]

    def run_tests(self) -> None:
        """Run comprehensive tests with various question types"""
        
        test_cases = self._get_test_cases()
        
        print("=" * 80)
        print("ðŸ¤– RAG CHATBOT UNIT TESTS")
        print("=" * 80)
        print()
        
        total_tests = 0
        total_score = 0
        
        for test_group in test_cases:
            print(f"ðŸ“‚ {test_group['category']}")
            print("-" * 50)
            
            for question in test_group['questions']:
                total_tests += 1
                print(f"\nâ“ Ð’ÑŠÐ¿Ñ€Ð¾Ñ: {question}")
                
                result = self.test_query(question)
                score = result.get('score', 0)
                answer = result.get('answer', 'ÐÑÐ¼Ð° Ð¾Ñ‚Ð³Ð¾Ð²Ð¾Ñ€')
                sources = result.get('sources', [])
                
                total_score += score
                
                print(f"ðŸ“Š Score: {score}/100")
                print(f"ðŸ’¬ ÐžÑ‚Ð³Ð¾Ð²Ð¾Ñ€: {answer}")
                
                if sources:
                    print(f"ðŸ“š Ð˜Ð·Ñ‚Ð¾Ñ‡Ð½Ð¸Ñ†Ð¸ ({len(sources)}):")
                    for source in sources[:3]:  # Show max 3 sources
                        source_id = source.get('source_id', 'N/A')
                        relevance = source.get('relevance', 0)
                        print(f"   â€¢ {source_id} ({relevance:.1f}%)")
                
                # Add small delay to avoid overwhelming the API
                time.sleep(0.5)
            
            print("\n" + "=" * 50)
        
        # Summary
        avg_score = total_score / total_tests if total_tests > 0 else 0
        high_score_tests = sum(1 for _ in range(total_tests) if avg_score >= 80)
        
        print(f"\nðŸ“ˆ SUMMARY:")
        print(f"   Total tests: {total_tests}")
        print(f"   Average score: {avg_score:.1f}/100")
        print(f"   Tests above 80: {high_score_tests}")
        print(f"   Success rate: {(high_score_tests/total_tests)*100:.1f}%")
        
        # Category breakdown
        print(f"\nðŸ“Š CATEGORY BREAKDOWN:")
        for test_group in test_cases:
            category_tests = len(test_group['questions'])
            print(f"   {test_group['category']}: {category_tests} tests")
        
        print("=" * 80)

def main():
    """Main function to run the tests"""
    import argparse
    
    parser = argparse.ArgumentParser(description='RAG Chatbot Unit Tests')
    parser.add_argument('--url', default='http://localhost:8000', 
                       help='Base URL of the chatbot API (default: http://localhost:8000)')
    parser.add_argument('--category', help='Run tests for specific category only')
    parser.add_argument('--list-categories', action='store_true', 
                       help='List all available test categories')
    
    args = parser.parse_args()
    
    tester = ChatbotTester(base_url=args.url)
    
    if args.list_categories:
        print("ðŸ“‹ Available test categories:")
        test_cases = tester._get_test_cases()
        for i, test_group in enumerate(test_cases, 1):
            print(f"   {i}. {test_group['category']} ({len(test_group['questions'])} tests)")
        return
    
    if args.category:
        print(f"Starting RAG Chatbot Unit Tests for category: {args.category}")
        print(f"Make sure the chatbot is running on {args.url}")
        print()
        tester.run_category_test(args.category)
    else:
        print("Starting RAG Chatbot Unit Tests...")
        print(f"Make sure the chatbot is running on {args.url}")
        print()
        tester.run_tests()

if __name__ == "__main__":
    main()
